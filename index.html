<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patch Code Batch Scanning Sample</title>
    <script src="https://unpkg.com/dwt@18.0.0/dist/dynamsoft.webtwain.min.js"></script>
    <style>
    </style>
  </head>
  <body>
    <div class="app">
      <h2 class="title">Batch Document Scanning with Patch Code</h2>
      <button onclick="scan();">Scan</button>
      <button onclick="loadFile();">Load File</button>
      <span id="status"></span>
      <div id="dwtcontrolContainer"></div>
    </div>
    <script>
      let DWObject;
      window.onload = function(){
        Dynamsoft.DWT.AutoLoad = false;
        Dynamsoft.DWT.ResourcesPath = "https://unpkg.com/dwt@18.0.0/dist";
        init();
      }

      function init(){
        const status = document.getElementById("status");
        Dynamsoft.DWT.Containers = [{ ContainerId: 'dwtcontrolContainer',Width: 270, Height: 350 }];
        Dynamsoft.DWT.RegisterEvent('OnWebTwainReady', function () {
          console.log("ready");
          status.innerText = "";
          DWObject = Dynamsoft.DWT.GetWebTwain('dwtcontrolContainer');
          DWObject.SetViewMode(2,2);
        });
        status.innerText = "Loading...";
        Dynamsoft.DWT.Load();
      }

      function scan() {
        if (DWObject) {
          DWObject.SelectSource(function () {
            DWObject.OpenSource();
            DWObject.AcquireImage();
          },
            function () {
              console.log("SelectSource failed!");
            }
          );
        }
      }

      function loadFile() {
        function OnSuccess() {
          console.log('successful');
        }

        function OnFailure(errorCode, errorString) {
          alert(errorString);
        }
        DWObject.IfShowFileDialog = true;
        // PDF Rasterizer Addon is used here to ensure PDF support
        DWObject.Addon.PDF.SetResolution(200);
        DWObject.Addon.PDF.SetConvertMode(Dynamsoft.DWT.EnumDWT_ConvertMode.CM_RENDERALL);
        DWObject.LoadImageEx("", Dynamsoft.DWT.EnumDWT_ImageType.IT_ALL, OnSuccess, OnFailure);
      }
    </script>
  </body>
</html>